{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.StreamDescription = void 0;\nconst server_description_1 = require(\"../sdam/server_description\");\nconst common_1 = require(\"../sdam/common\");\nconst RESPONSE_FIELDS = ['minWireVersion', 'maxWireVersion', 'maxBsonObjectSize', 'maxMessageSizeBytes', 'maxWriteBatchSize', 'logicalSessionTimeoutMinutes'];\n/** @public */\nclass StreamDescription {\n  constructor(address, options) {\n    this.address = address;\n    this.type = common_1.ServerType.Unknown;\n    this.minWireVersion = undefined;\n    this.maxWireVersion = undefined;\n    this.maxBsonObjectSize = 16777216;\n    this.maxMessageSizeBytes = 48000000;\n    this.maxWriteBatchSize = 100000;\n    this.compressors = options && options.compressors && Array.isArray(options.compressors) ? options.compressors : [];\n  }\n  receiveResponse(response) {\n    this.type = server_description_1.parseServerType(response);\n    RESPONSE_FIELDS.forEach(field => {\n      if (typeof response[field] !== 'undefined') {\n        this[field] = response[field];\n      }\n      // testing case\n      if ('__nodejs_mock_server__' in response) {\n        this.__nodejs_mock_server__ = response['__nodejs_mock_server__'];\n      }\n    });\n    if (response.compression) {\n      this.compressor = this.compressors.filter(c => {\n        var _a;\n        return (_a = response.compression) === null || _a === void 0 ? void 0 : _a.includes(c);\n      })[0];\n    }\n  }\n}\nexports.StreamDescription = StreamDescription;","map":{"version":3,"names":["server_description_1","require","common_1","RESPONSE_FIELDS","StreamDescription","constructor","address","options","type","ServerType","Unknown","minWireVersion","undefined","maxWireVersion","maxBsonObjectSize","maxMessageSizeBytes","maxWriteBatchSize","compressors","Array","isArray","receiveResponse","response","parseServerType","forEach","field","__nodejs_mock_server__","compression","compressor","filter","c","_a","includes","exports"],"sources":["C:\\Users\\pranav kamat\\node_modules\\mongodb\\src\\cmap\\stream_description.ts"],"sourcesContent":["import { parseServerType } from '../sdam/server_description';\nimport type { Document } from '../bson';\nimport type { CompressorName } from './wire_protocol/compression';\nimport { ServerType } from '../sdam/common';\n\nconst RESPONSE_FIELDS = [\n  'minWireVersion',\n  'maxWireVersion',\n  'maxBsonObjectSize',\n  'maxMessageSizeBytes',\n  'maxWriteBatchSize',\n  'logicalSessionTimeoutMinutes'\n] as const;\n\n/** @public */\nexport interface StreamDescriptionOptions {\n  compressors?: CompressorName[];\n}\n\n/** @public */\nexport class StreamDescription {\n  address: string;\n  type: string;\n  minWireVersion?: number;\n  maxWireVersion?: number;\n  maxBsonObjectSize: number;\n  maxMessageSizeBytes: number;\n  maxWriteBatchSize: number;\n  compressors: CompressorName[];\n  compressor?: CompressorName;\n  logicalSessionTimeoutMinutes?: number;\n\n  __nodejs_mock_server__?: boolean;\n\n  zlibCompressionLevel?: number;\n\n  constructor(address: string, options?: StreamDescriptionOptions) {\n    this.address = address;\n    this.type = ServerType.Unknown;\n    this.minWireVersion = undefined;\n    this.maxWireVersion = undefined;\n    this.maxBsonObjectSize = 16777216;\n    this.maxMessageSizeBytes = 48000000;\n    this.maxWriteBatchSize = 100000;\n    this.compressors =\n      options && options.compressors && Array.isArray(options.compressors)\n        ? options.compressors\n        : [];\n  }\n\n  receiveResponse(response: Document): void {\n    this.type = parseServerType(response);\n    RESPONSE_FIELDS.forEach(field => {\n      if (typeof response[field] !== 'undefined') {\n        this[field] = response[field];\n      }\n\n      // testing case\n      if ('__nodejs_mock_server__' in response) {\n        this.__nodejs_mock_server__ = response['__nodejs_mock_server__'];\n      }\n    });\n\n    if (response.compression) {\n      this.compressor = this.compressors.filter(c => response.compression?.includes(c))[0];\n    }\n  }\n}\n"],"mappings":";;;;;;AAAA,MAAAA,oBAAA,GAAAC,OAAA;AAGA,MAAAC,QAAA,GAAAD,OAAA;AAEA,MAAME,eAAe,GAAG,CACtB,gBAAgB,EAChB,gBAAgB,EAChB,mBAAmB,EACnB,qBAAqB,EACrB,mBAAmB,EACnB,8BAA8B,CACtB;AAOV;AACA,MAAaC,iBAAiB;EAgB5BC,YAAYC,OAAe,EAAEC,OAAkC;IAC7D,IAAI,CAACD,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACE,IAAI,GAAGN,QAAA,CAAAO,UAAU,CAACC,OAAO;IAC9B,IAAI,CAACC,cAAc,GAAGC,SAAS;IAC/B,IAAI,CAACC,cAAc,GAAGD,SAAS;IAC/B,IAAI,CAACE,iBAAiB,GAAG,QAAQ;IACjC,IAAI,CAACC,mBAAmB,GAAG,QAAQ;IACnC,IAAI,CAACC,iBAAiB,GAAG,MAAM;IAC/B,IAAI,CAACC,WAAW,GACdV,OAAO,IAAIA,OAAO,CAACU,WAAW,IAAIC,KAAK,CAACC,OAAO,CAACZ,OAAO,CAACU,WAAW,CAAC,GAChEV,OAAO,CAACU,WAAW,GACnB,EAAE;EACV;EAEAG,eAAeA,CAACC,QAAkB;IAChC,IAAI,CAACb,IAAI,GAAGR,oBAAA,CAAAsB,eAAe,CAACD,QAAQ,CAAC;IACrClB,eAAe,CAACoB,OAAO,CAACC,KAAK,IAAG;MAC9B,IAAI,OAAOH,QAAQ,CAACG,KAAK,CAAC,KAAK,WAAW,EAAE;QAC1C,IAAI,CAACA,KAAK,CAAC,GAAGH,QAAQ,CAACG,KAAK,CAAC;;MAG/B;MACA,IAAI,wBAAwB,IAAIH,QAAQ,EAAE;QACxC,IAAI,CAACI,sBAAsB,GAAGJ,QAAQ,CAAC,wBAAwB,CAAC;;IAEpE,CAAC,CAAC;IAEF,IAAIA,QAAQ,CAACK,WAAW,EAAE;MACxB,IAAI,CAACC,UAAU,GAAG,IAAI,CAACV,WAAW,CAACW,MAAM,CAACC,CAAC,IAAG;QAAA,IAAAC,EAAA;QAAC,QAAAA,EAAA,GAAAT,QAAQ,CAACK,WAAW,cAAAI,EAAA,uBAAAA,EAAA,CAAEC,QAAQ,CAACF,CAAC,CAAC;MAAA,EAAC,CAAC,CAAC,CAAC;;EAExF;;AA9CFG,OAAA,CAAA5B,iBAAA,GAAAA,iBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}